.. _pd_handler_ble:

BLEデバイス情報送信設定
==============================

| WEB UIの「IoTデータ」→「送受信設定」タブの「BLEデバイス情報送信設定」メニューより、
| BLEデバイス情報の送信設定を行うことが出来ます。
| BLEデバイス情報の送信を行うためには、WEB UIの「サービス」→「基本」→「BT I/F」タブより、
  サービス機能の基本設定としてBT I/F (hci0)が「使用する」に設定されている必要があります。
| また、WEB UIの「サービス」→「基本」→「BLE登録」タブより、
  サービス機能の基本設定としてBLEデバイスが登録されている必要があります。
| サービス機能の基本設定については、:ref:`webui` の :ref:`webui_service` を参照して下さい。
| 「BLEデバイス情報送信設定」メニューが表示されていない場合は、:ref:`data_handler_application` を参照し、
  PD Handler BLEを「使用する」に設定して下さい。

.. figure:: ble_init.png
  :scale: 100%

登録済のBLEデバイスが存在している場合、初期状態では上図のようになっています。(デバイスが１個登録されている場合です。)

| デバイス毎に送信対象項目にて「送信する」を選択すると各設定項目が表示されます。
| 送信対象一括有効、送信対象一括無効ボタンにて全ての登録済のデバイスの送信対象を制御できます。

.. figure:: ble.png
  :scale: 100%

「送信する」を選択すると各設定項目が上図のように表示されます。

.. list-table:: BLEデバイス情報送信設定の設定項目
    :widths: 30 70
    :header-rows: 1
    
    * - 設定項目
      - 説明
    * - デバイス番号
      - OpenBlocksシリーズのWEB UI内で管理している番号です。変更はできません。
    * - データ間引間隔
      - データを間引くための入力データを受け取らない時間をmsec単位で設定します。　
        0の場合、間引きは行われません。
    * - バッファーサイズ
      - データの最大サイズを設定します。単位はバイトです。
    * - アドレス
      - 登録されたデバイスのBTのアドレスを表示します。
    * - ユーザーメモ
      - 登録されたデバイスにて設定されたメモ情報を表示します。
    * - センサー信号強度[dbm]
      - センサーに信号強度を設定できる機種の場合、設定したい信号強度を入力します。 
        設定した信号強度が無い場合、近似値またはデフォルト値が設定されます。
    * - 取得時間間隔[ms]
      - センサーからデータを取得する時間間隔を数字で設定します。単位はmsecです。 \*1
    * - 固定情報付与(JSON)
      - データに付加する静的情報をJSON文字列で設定します。
    * - 送信先設定
      - "使用する"を選択した送信先に対してチェックボックスが選択できるようになります。 
        チェックを付けた送信先に対して、送信を行います。　
        チェックをつけると送信先固有の設定項目が表示されます。　
        送信先固有の設定については、:ref:`pd_repeater_device` を参照して下さい。

.. note::
  1. 富士通コンポーネント製BT Smartセンサービーコン"と"Texas Instruments製SimpleLink SensorTag"のみサポートしています。
  
  * 既存のデバイス不良等の差し替え時に以前のものと同様に扱う為に設定を同一にすることを推奨します。
    （不良となったデバイスは送信対象設定を「送信しない」へ変更してください。）

.. raw:: latex

   \clearpage
