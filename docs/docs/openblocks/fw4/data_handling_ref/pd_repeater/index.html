<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<title data-react-helmet="true">PD Repeater | ぷらっとホームどきゅめんと</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="PD Repeater | ぷらっとホームどきゅめんと"><meta data-react-helmet="true" name="description" content="OpenBlocksに用いているIoTゲートウェイソフトウェア「FW4」のデータハンドリング設定リファレンスガイドに関するドキュメントの「PD Repeater」のページです。"><meta data-react-helmet="true" property="og:description" content="OpenBlocksに用いているIoTゲートウェイソフトウェア「FW4」のデータハンドリング設定リファレンスガイドに関するドキュメントの「PD Repeater」のページです。"><meta data-react-helmet="true" name="keywords" content="IoT,Data Handling,PD Repeater,repeater,reference"><meta data-react-helmet="true" property="og:url" content="https://docs.plathome.co.jp/docs/openblocks/fw4/data_handling_ref/pd_repeater"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.plathome.co.jp/docs/openblocks/fw4/data_handling_ref/pd_repeater"><link rel="stylesheet" href="/styles.62ee93f5.css">
<link rel="preload" href="/styles.ed7e2b4f.js" as="script">
<link rel="preload" href="/runtime~main.964a68ee.js" as="script">
<link rel="preload" href="/main.b9e3c0f9.js" as="script">
<link rel="preload" href="/1.b61b1d06.js" as="script">
<link rel="preload" href="/1a4e3797.18730606.js" as="script">
<link rel="preload" href="/1be78505.a4225882.js" as="script">
<link rel="preload" href="/c4f5d8e4.062d164b.js" as="script">
<link rel="preload" href="/151.32671e9d.js" as="script">
<link rel="preload" href="/150.05840bde.js" as="script">
<link rel="preload" href="/935f2afb.93164eec.js" as="script">
<link rel="preload" href="/149.3a8133d2.js" as="script">
<link rel="preload" href="/6c629441.4d4f598f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbarHideable_3046 navbarHidden_1Uo_"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo_plathome_white.png" alt="ぷらっとホーム" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo_plathome_white.png" alt="ぷらっとホーム" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">ぷらっとホームどきゅめんと</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://www.plathome.co.jp/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">会社トップ</a><a href="https://www.plathome.co.jp/support/topix-software-update/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">アップデート情報</a><a href="https://kb.plathome.co.jp/knowledge/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">FAQ</a><a href="https://blog.plathome.co.jp/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">ブログ</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search searchBarContainer_1-U_"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_18Th searchBarLoadingRing_zYFK"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo_plathome_white.png" alt="ぷらっとホーム" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo_plathome_white.png" alt="ぷらっとホーム" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">ぷらっとホームどきゅめんと</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://www.plathome.co.jp/" target="_blank" rel="noopener noreferrer" class="menu__link">会社トップ</a></li><li class="menu__list-item"><a href="https://www.plathome.co.jp/support/topix-software-update/" target="_blank" rel="noopener noreferrer" class="menu__link">アップデート情報</a></li><li class="menu__list-item"><a href="https://kb.plathome.co.jp/knowledge/" target="_blank" rel="noopener noreferrer" class="menu__link">FAQ</a></li><li class="menu__list-item"><a href="https://blog.plathome.co.jp/" target="_blank" rel="noopener noreferrer" class="menu__link">ブログ</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC sidebarWithHideableNavbar_2IoJ"><a tabindex="-1" class="sidebarLogo_Snse" href="/"><img src="/img/logo_plathome_white.png" alt="ぷらっとホーム" class="themedImage_2E_h themedImage--light_AouX"><img src="/img/logo_plathome_white.png" alt="ぷらっとホーム" class="themedImage_2E_h themedImage--dark_1YPN"><strong>ぷらっとホームどきゅめんと</strong></a><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">免責・商標一覧</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">免責事項と商標について</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/doclist">ドキュメント一覧</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">OpenBlocks</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">ハードウェア</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/bx0_spec">OpenBlocks IoT BX0</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/bx1_spec">OpenBlocks IoT BX1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/bx3_spec">OpenBlocks IoT BX3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/bx5_spec">OpenBlocks IoT BX5</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/ex1_spec">OpenBlocks IoT EX1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/vx1_spec">OpenBlocks IoT VX1</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/vx2_spec">OpenBlocks IoT VX2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/ix9_spec">OpenBlocks IX9</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/iotmodule_spec">OpenBlocks用モジュールetc</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/hardware/common">その他オプション</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">ソフトウェア</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Debian Linux FW4</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">スタートアップガイド</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/first/first">WEB-UI接続準備</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/initial/initial">初期設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/airmanage/airmanage">遠隔管理AirManage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/service/service">サービスの追加</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">サービスガイド</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/basic">基本(IoTデータ必読)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/iotdata">IoTデータ設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/nodered">Node-RED設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/camera">カメラ機能</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/docker">Docker/Moby設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/iotedge">Azure IoT Edge設定</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">拡張サービスガイド</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/samba">Samba設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/ftp_server">FTPサーバー設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/ftp_download">FTPダウンロード設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/ftp_upload">FTPアップロード設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/service/secure">不正ログイン監視(セキュリティ)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">WEB-UIガイド</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/index">WEB-UIタブ別インデックス</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/dashboard">ダッシュボード</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/system">システム関連の設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/network">ネットワーク関連の設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/storage">ストレージ関連の設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/maintenance">メンテナンス関連の設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/smscontrol">SMSコントロール</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/webui/reference/etcetera">その他の設定</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">センサーデータの受信</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_handler">PD Handler</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">センサーI/F毎の設定</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/beacon">BLEビーコン送信設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/ble">BLEデバイス情報送信設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/enocean">EnOceanデバイス設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/wi-sun_b">Wi-SUN Bルート情報送信設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus/client">Modbusクライアント設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus/server">Modbusサーバー設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus2/client">Modbus2クライアント設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus2/server">Modbus2サーバー設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/sw4x/sw4x">SW4xデバイス設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/hvsmc">高圧スマートメータ設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/user_dev">デバイス設定(ユーザー定義)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/log">IoTデータ制御ツールログ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/sensor_data">BLEセンサーグラフ表示</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">対応センサJSONフォーマット</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_form/ble">BLEビーコン&amp;センサー</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_form/enocean">EnOceanセンサー</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_form/wisun">低圧スマートメーター</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_form/hvsmc">高圧スマートメーター</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_form/modbus_merge">Modbus PLC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_form/sw4x">ミスター省エネ</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">IoTクラウド/サーバー送受信</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/pd_repeater">PD Repeater 送受信設定</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">送受信先毎の設定</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/lo">本体内データベース</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/dexpf">DEXPF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/dexpf_ws">DEXPF[Websocket]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/iothub">MS Azure IoT Hub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/iothub_ws">MS Azure IoT Hub[Websocket]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/awsiot">AWS IoT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/awsiot_ws">AWS IoT[Websocket]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/iotcore">Google IoT Core</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/w4g">Watson IoT for Gateway</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/eventhub">MS Azure Event hubs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/kinesis">Amazon Kinesis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/w4d">Watson IoT for Device</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/t4d">Toami for DOCOMO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/sbiot">SoftBank スマ可視専用クラウド</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/kddi_std">KDDI IoT クラウド Standard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/pd_web">PHオリジナルWEBサーバー</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/web">WEBサーバー</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/mqtt">MQTTサーバー</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/ltcp">TCPサーバー</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/pd_ex">PD Exchange</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/lsocket">ユニックスドメインソケット</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">下流方向デバイス制御</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/down_stream">下流方向制御の概要</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/down_stream_message">PD Repeaterの下流方向メッセージ</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Modbus</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus/down_stream">Modbusの下流方向制御</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus/down_stream_client">Modbusクライアント</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus/down_stream_server">Modbusサーバー</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Modbus2</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus2/down_stream_client">Modbus2クライアント</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/modbus2/down_stream_server">Modbus2サーバー</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/sw4x/down_stream">ミスター省エネSW4x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_agent">PD Agent</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_repeater/down_stream_cloud_matter">デバイス制御方式に依存した送信メッセージ構文</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">開発者向けガイド</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/developer/before_use/before_use">カスタマイズ前の注意と補足</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/developer/how_to_use/how_to_use">OpenBlocks HW 制御ソフト</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">カスタマイズ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/user_app">カスタムデータ収集アプリ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/user_app_down_stream">下流方向制御アプリ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/rc">自作アプリの起動・停止制御</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/deb_package">deb パッケージ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/check_rc">アプリケーション設定の確認</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/advanced">複雑な構成の実現</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/pd_broker">PD Broker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/lua_extention">LUA言語拡張ハンドラ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/adjust">PDHMSの調整</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/data_handling/csv_data">CSVデータ送信機能</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">PDHMS リファレンス</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/index">索引</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/common">共通事項</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/pd_repeater">PD Repeater</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/pd_broker">PD Broker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/pd_agent">PD Agent</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/ble">PD Handler BLE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/uart">PD Handler UART</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/hvsmc">PD Handler HVSMC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/modbus">PD Handler Modbus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/modbus2">PD Handler Modbus 2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw4/data_handling_ref/sw4x">PD Handler SW4x</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Node-REDスターターガイド</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/node-red/easy-exp/easy-exp">Node-REDの簡易説明</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/node-red/sample/sample">ノード操作サンプル</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">OpenBlocks IoTチュートリアル</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">EnOceanデータをIoT Hubへ送信</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/iothub/preface">はじめに</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/iothub/azure_iot_hub">IoT Hubの設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/iothub/openblocks_iot">OpenBlocks IoTの設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/iothub/check">動作確認</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/iothub/reference">参考ページ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">BLEデータをAWS IoTへ送信</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/awsiot/preface">はじめに</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/awsiot/aws_iot_core">AWS IoT Coreの設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/awsiot/openblocks_iot">OpenBlocks IoTの設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/awsiot/check">動作確認</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/awsiot/reference">参考ページ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">CO2データをMQTTサーバーへ送信</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/mqtt/preface">はじめに</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/mqtt/mqtt_server">MQTTサーバーの準備</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/mqtt/openblocks_iot">OpenBlocks IoTの設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/mqtt/check">Node-REDでグラフを作る</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/fw4/tutorial/mqtt/reference">参考ページ</a></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/fw3">FW3版ドキュメント一覧(PDF)</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">FW共通/工場出荷状態に戻す</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openblocks/factory/factory_reset">ファクトリーリセット</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/ramdisk">Debian RAM disk版</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openblocks/windows">Windows版スタートガイド</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">EasyBlocksアプライアンス</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/easyblocks/dhcp">EasyBlocks DHCP</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/easyblocks/syslog">EasyBlocks Syslog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/easyblocks/packetix">EasyBlocks PacketiX VPNアプライアンス</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/easyblocks/remote">EasyBlocks Remote Office</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">AirManage遠隔監視</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/amdoc/amdoc_1">はじめに</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/amdoc/amdoc_2">初期設定</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/amdoc/amdoc_3">運用(システム管理者向け)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/amdoc/amdoc_4">運用(テナント管理者向け)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/amdoc/amdoc_webapi">WebAPI</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2Tub"></button></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">PD Repeater</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="デフォルトパス"></a><span id="path">デフォルトパス</span><a aria-hidden="true" class="hash-link" href="#デフォルトパス" title="Direct link to heading">#</a></h2><p>PD Repeater に関連するファイルのデフォルトパスは次の通りです。</p><blockquote><p>PD Repeater に関連するファイルのデフォルトパス</p></blockquote><table><thead><tr><th>パス名</th><th>説明</th></tr></thead><tbody><tr><td>/usr/sbin/pd_repeater</td><td>常駐実行オブジェクト（デーモン）</td></tr><tr><td>/usr/sbin/pd_repeater_p</td><td>実行オブジェクト（ユーティリティー）</td></tr><tr><td>/lib/systemd/system/pd_repeater.service</td><td>Systemd Service ファイル</td></tr><tr><td>/etc/init.d/pd_repeater</td><td>RC ファイル</td></tr><tr><td>/var/webui/config/pd_repeater.conf</td><td>設定ファイル</td></tr><tr><td>/var/run/pd_repeater.pid</td><td>PID ファイル</td></tr><tr><td>/var/webui/pd-data/pd_repeater.db</td><td>キャッシュファイル</td></tr><tr><td>@/pd_repeater/&lt;デバイス番号&gt;.sock</td><td>入力 UNIX ドメインソケット</td></tr><tr><td>@/pd_handler/&lt;デバイス番号&gt;.sock</td><td>出力 UNIX ドメインソケット</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="設定ファイルの書式"></a><span id="conf">設定ファイルの書式</span><a aria-hidden="true" class="hash-link" href="#設定ファイルの書式" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="構文"></a><span id="syntax">構文</span><a aria-hidden="true" class="hash-link" href="#構文" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-json:pd_repeater.conf codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;db_file&quot;: &quot;&lt;キャッシュファイル パス名&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;max_db_size&quot;: &lt;キャッシュサイズ&gt;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;servers&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;クラウドインデックスキー&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;サーバ設定用 JSON オブジェクト&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;クラウドインデックスキー&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;サーバの設定用 JSON オブジェクト&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;devices&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;localname&quot;: &quot;&lt;デバイスのローカル名&gt;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;bind&quot;: &quot;&lt;受信ソケット名&gt;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;push_to&quot;: &quot;&lt;送信先ソケット名&gt;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;buffer_size&quot;: &lt;バッファサイズ&gt;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;truncate&quot;: &lt;入力データを受け付けない時間&gt;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;receive&quot;: &lt;bool値&gt;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;&lt;クラウドインデックスキー&gt;&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;クラウド固有のデバイス設定用 JSON オブジェクト&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       &quot;&lt;クラウドインデックスキー&gt;&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           &lt;クラウド固有のデバイス設定用 JSON オブジェクト&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="ルートオブジェクト"></a><span id="root_obj">ルートオブジェクト</span><a aria-hidden="true" class="hash-link" href="#ルートオブジェクト" title="Direct link to heading">#</a></h3><blockquote><p>ルートオブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>db_file</td><td>文字列</td><td>キャシュファイルのパス名. デフォルト値は &#x27;/var/webui/pd-data/pd_repeater.db&#x27;. (MAXPATHLEN)</td></tr><tr><td>max_db_size</td><td>整数値</td><td>キャシュファイルの最大サイズ(Mbyte). デフォルト値は16.</td></tr><tr><td>servers</td><td>JSON obj</td><td>servers オブジェクト</td></tr><tr><td>devices</td><td>JSON 配列  devices オブジェクト</td><td></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="servers-オブジェクト"></a><span id="servers_obj">servers オブジェクト</span><a aria-hidden="true" class="hash-link" href="#servers-オブジェクト" title="Direct link to heading">#</a></h3><blockquote><p>servers オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td><a href="#pd_ex">pd_ex</a></td><td>JSON obj</td><td>PD Exchenge へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#mqtt">mqtt</a></td><td>JSON obj</td><td>汎用のMQTT ブローカーへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#mqtt">w4d</a></td><td>JSON obj</td><td>IBM Watson IoT for device へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#kinesis">kinesis</a></td><td>JSON obj</td><td>Amazon Kinesis へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#pgsql">pgsql</a></td><td>JSON obj</td><td>PostgreSQL データベースへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#mysql">mysql</a></td><td>JSON obj</td><td>MySQL データベースへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#web">web</a></td><td>JSON obj</td><td>汎用のWeb サーバへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#awsiot">awsiot</a></td><td>JSON obj</td><td>Amazon AWS IoT へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#eventhub">eventhub</a></td><td>JSON obj</td><td>Microsoft Azure Event Hubs へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#w4g">w4g</a></td><td>JSON obj</td><td>IBM Watson IoT for gateway へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#iothub">iothub</a></td><td>JSON obj</td><td>Microsoft Azure IoT Hub へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#t4d">t4d</a></td><td>JSON obj</td><td>NTT docomo Toami for DOCOMO へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#lsocket">lsocket</a></td><td>JSON obj</td><td>Unixドメインソケットへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#kddi_std">kddi_std</a></td><td>JSON obj</td><td>KDDI IoT クラウドStandard へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#nf_dvhub">nf_dvhub</a></td><td>JSON obj</td><td>NIFTY IoT Device Hub へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#pd_web">pd_web</a></td><td>JSON obj</td><td>Plat&#x27;Home 独自仕様の Web サーバへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#iotcore">iotcore</a></td><td>JSON obj</td><td>Google Cloud IoT Core へデータを送るための設定オブジェクト</td></tr><tr><td><a href="#ltcp">ltcp</a></td><td>JSON obj</td><td>TCP ソケットへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#awsiot_ws">awsiot_ws</a></td><td>JSON obj</td><td>Amazon AWS IoT へ　MQTT over WEbsocket でデータを送るための設定オブジェクト</td></tr><tr><td><a href="#iothub_ws">iothub_ws</a></td><td>JSON obj</td><td>Microsoft Azure IoT Hub へ MQTTover Websocket でデータを送るための設定オブジェクト</td></tr><tr><td><a href="#dummy">dummy</a></td><td>JSON obj</td><td>ログ出力のみ行うダミー出力ための設定オブジェクト</td></tr><tr><td><a href="#sbiot">sbiot</a></td><td>JSON obj</td><td>SoftBank IoTへデータを送るための設定オブジェクト</td></tr><tr><td><a href="#ftp">ftp</a></td><td>JSON obj</td><td>FTP サーバへデータを送るための設定オブジェクト</td></tr></tbody></table><p>クラウドインデックスキーとして同文字列に &#x27;_0&#x27; 又は &#x27;_1&#x27;, &#x27;_2&#x27;, &#x27;_3&#x27; を付加した文字列 (例えば &#x27;pd_ex&#x27; について、&#x27;pd_ex_0&#x27;, &#x27;pd_ex_1&#x27;, &#x27;pd_ex_2&#x27;, &#x27;pd_ex_3&#x27;) を用いることで、
同一のクラウドの異る 4 つのサーバーもしくはエンドポイントを設定することも可能です。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="pd-exchengpd_ex"></a><span id="pd_ex">PD Excheng(pd_ex)</span><a aria-hidden="true" class="hash-link" href="#pd-exchengpd_ex" title="Direct link to heading">#</a></h4><blockquote><p>PD Exchange (pd ex) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は604800、0 の場合は再起動しない.</td></tr><tr><td>url</td><td>文字列</td><td>接続先URL. デフォルト値は <a href="http://pd.plathome.com" target="_blank" rel="noopener noreferrer">http://pd.plathome.com</a> (MAXPATHLEN)</td></tr><tr><td>ssl_verify</td><td>論理値</td><td>サーバー証明書の検証を行うか否か. デフォルト値は false.</td></tr><tr><td>poll_interval</td><td>整数値</td><td>PD Exchange からコマンド(下流方向へのメッセージ)を読み出す間隔(sec). デフォルト値は 30.</td></tr><tr><td>deid_prefix</td><td>文字列</td><td>PD Exchange のデバイスID プリフィック. (10byte)</td></tr><tr><td>secretkey</td><td>文字列</td><td>接続に用いるsecretkey. (16byte)</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="汎用-mqtt-ブローカーmqtt"></a><span id="mqtt">汎用 MQTT ブローカー(mqtt)</span><a aria-hidden="true" class="hash-link" href="#汎用-mqtt-ブローカーmqtt" title="Direct link to heading">#</a></h4><blockquote><p>汎用MQTTブローカー(mqtt)の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>host</td><td>文字列</td><td>接続先ホストをIP アドレス又は FQDN で指定. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル &#x27;tcp&#x27; 又は &#x27;ssl&#x27; を指定. デフォルト値は &#x27;tcp&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 1883(TCP 接続時) 又は 8883(SSL 接続時).</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値は true.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>forward_match</td><td>論理値</td><td>受信トピックの前方一致のリファレンスを送られて来たトピックから設定された受信トピックに切り替える. デフォルト値は false.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値は false.</td></tr><tr><td>client_id</td><td>文字列</td><td>MQTT 接続に用いる Client ID. (96byte)</td></tr><tr><td>topic_prefix</td><td>文字列</td><td>MQTT の送信トピックの先頭に付加する文字列. 送信トピックは、本文字列と<a href="#mqtt_dev">デバイス設定オブジェクト</a>の　&#x27;unique id&#x27; に指定される文字列の組み合わせで、&lt;topic_prefix&gt;/&lt;unique_id&gt; となる. (MAXPATHLEN)</td></tr><tr><td>rcv_topic_prefix</td><td>文字列</td><td>MQTT の受信トピックの先頭に付加する文字列. 受信トピックは、 &lt;rcv_topic_prefix&gt;/# で待ち受け、<a href="#mqtt_dev">デバイス設定オブジェクト</a>の &#x27;unique_id&#x27; に指定される文字列の組み合わせからなる &lt;rcv_topic_prefix&gt;/&lt;unique_id&gt;と完全一致するデバイスへ受信メッセージを転送する. 完全一致しない場合は、前方一致により一致する複数のデバイスへ受信メッセージを転送する. (MAXPATHLEN)</td></tr><tr><td>lwt_topic_prefix</td><td>文字列</td><td>LWT の送信トピックの先頭に付加する文字列. 送信トピックは、本文字列と<a href="#mqtt_dev">デバイス設定オブジェクト</a>の &#x27;unique_id&#x27; に指定される文字列の組み合わせで、&lt;lwt_topic_prefix&gt;/&lt;unique_id&gt;となる. (MAXPATHLEN)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr><tr><td>username</td><td>文字列</td><td>接続に用いるユーザー名. (96byte)</td></tr><tr><td>password</td><td>文字列</td><td>パスワード認証に用いるパスワード. (128byte)</td></tr><tr><td>truststore</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>keystore</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ibm-watson-iot-for-device-w4d"></a><span id="w4d">IBM Watson IoT for device (w4d)</span><a aria-hidden="true" class="hash-link" href="#ibm-watson-iot-for-device-w4d" title="Direct link to heading">#</a></h4><blockquote><p>IBM Watson IoT for device (w4d) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は &#x27;messag-ing.internetofthings.ibmcloud.com&#x27;. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル&#x27;tcp&#x27; 又は&#x27;ssl&#x27; を指定. デフォルト値は &#x27;tcp&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 1883(TCP 接続時)又は 8883(SSL 接続時).</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値は true.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値はfalse.</td></tr><tr><td>org_id</td><td>文字列</td><td>組織 ID. デフォルト値は &#x27;quickstart&#x27;. (16byte)</td></tr><tr><td>event_id</td><td>文字列</td><td>イベントID. デフォルト値は &#x27;sample&#x27;. (128byte)</td></tr><tr><td>lwt_event_id</td><td>文字列</td><td>LWT のイベント ID. デフォルト値は &#x27;lwt&#x27;.</td></tr><tr><td>format_string</td><td>文字列</td><td>データーフォーマット. デフォルト値は &#x27;json&#x27;. (16byte)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr><tr><td>truststore</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="amazon-kinesis-kinesis"></a><span id="kinesis">Amazon Kinesis (kinesis)</span><a aria-hidden="true" class="hash-link" href="#amazon-kinesis-kinesis" title="Direct link to heading">#</a></h4><blockquote><p>Amazon Kinesis (kinesis) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は&#x27;amazonaws.com&#x27;. (MAXHOSTNAMELEN)</td></tr><tr><td>ssl_verify</td><td>論理値</td><td>サーバー証明書の検証を行うか否か. デフォルト値は false.</td></tr><tr><td>region</td><td>文字列</td><td>接続先リージョン名. デフォルト値は &#x27;ap-northeast-1&#x27;. (64byte)</td></tr><tr><td>accessid</td><td>文字列</td><td>アクセスID. (128byte)</td></tr><tr><td>accesskey</td><td>文字列</td><td>アクセスキー. (128byte)</td></tr><tr><td>streamname</td><td>文字列</td><td>ストリーム名. (128byte)</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="postgresql-pgsql"></a><span id="pgsql">PostgreSQL (pgsql)</span><a aria-hidden="true" class="hash-link" href="#postgresql-pgsql" title="Direct link to heading">#</a></h4><blockquote><p>PostgreSQL (pgsql) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>hostaddr</td><td>文字列</td><td>接続先IP アドレス. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル &#x27;tcp&#x27; 又は &#x27;ssl&#x27; を指定.デフォルト値は &#x27;tcp&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 5432.</td></tr><tr><td>sslmode</td><td>文字列</td><td>PostgreSQL のSSL モード. デフォルト値は &#x27;verify-full&#x27;. (12byte)</td></tr><tr><td>pg_type</td><td>整数値</td><td>postgresql/server/catalog/pg_type.h に定義されるOID. デフォルト値は114(JSONOID).</td></tr><tr><td>dbname</td><td>文字列</td><td>データベース名. デフォルト値は &#x27;pd_repeater&#x27;. (32byte)</td></tr><tr><td>username</td><td>文字列</td><td>接続に用いるユーザー名. (32byte)</td></tr><tr><td>password</td><td>文字列</td><td>接続に持ちるパスワード. (32byte)</td></tr><tr><td>truststore</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>keystore</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="mysql-mysql"></a><span id="mysql">MySQL (mysql)</span><a aria-hidden="true" class="hash-link" href="#mysql-mysql" title="Direct link to heading">#</a></h4><blockquote><p>MySQL (mysql) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>hostaddr</td><td>文字列</td><td>接続先IP アドレス. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル &#x27;tcp&#x27; 又は &#x27;ssl&#x27; を指定. デフォルト値は&#x27; tcp&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 3306.</td></tr><tr><td>dbname</td><td>文字列</td><td>データベース名. デフォルト値は &#x27;pd repeater&#x27;. (32byte)</td></tr><tr><td>username</td><td>文字列</td><td>接続に用いるユーザー名. (32byte)</td></tr><tr><td>password</td><td>文字列</td><td>接続に持ちるパスワード. (32byte)</td></tr><tr><td>truststore</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>keystore</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="汎用の-web-サーバweb"></a><span id="web">汎用の Web サーバ(web)</span><a aria-hidden="true" class="hash-link" href="#汎用の-web-サーバweb" title="Direct link to heading">#</a></h4><blockquote><p>汎用の Web サーバ(web) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>url</td><td>文字列</td><td>接続先URL. (MAXPATHLEN)</td></tr><tr><td>ssl_verify</td><td>論理値</td><td>サーバー証明書の検証を行うか否か. デフォルト値は false.</td></tr><tr><td>username</td><td>文字列</td><td>BASIC 認証用ユーザー名. 空の場合、認証は行わない. (32byte)</td></tr><tr><td>password</td><td>文字列</td><td>BASIC 認証用パスワード. 空の場合、認証は行わない. (32byte)</td></tr><tr><td>max_post_msize</td><td>整数値</td><td>最大ポストサイズ(Mbyte). デフォルト値は 1.</td></tr><tr><td>content_type</td><td>文字列</td><td>&#x27;Content-Type&#x27; を指定する. &#x27;text/plain&#x27; もしくは&#x27;application/json&#x27; が指定された場合はペイロードの URL セーフエンコードを行わない. デフォルト値は無指定. (64byte)</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="amazon-aws-iot-awsiot"></a><span id="awsiot">Amazon AWS IoT (awsiot)</span><a aria-hidden="true" class="hash-link" href="#amazon-aws-iot-awsiot" title="Direct link to heading">#</a></h4><blockquote><p>Amazon AWS IoT (awsiot) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>host</td><td>文字列</td><td>接続先ホスト名. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル &#x27;tcp&#x27; 又は &#x27;ssl&#x27; を指定. デフォルト値は &#x27;tcp&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 8883.</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値は false.</td></tr><tr><td>rootCA</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft-azure-event-hubs-eventhub"></a><span id="eventhub">Microsoft Azure Event Hubs (eventhub)</span><a aria-hidden="true" class="hash-link" href="#microsoft-azure-event-hubs-eventhub" title="Direct link to heading">#</a></h4><blockquote><p>Microsoft Azure Event Hubs (eventhub) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は&#x27;servicebus.windows.net&#x27;. (MAX-HOSTNAMELEN)</td></tr><tr><td>namespace</td><td>文字列</td><td>接続先名前空間. (64byte)</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 5671.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ibm-watson-iot-for-gateway-w4g"></a><span id="w4g">IBM Watson IoT for gateway (w4g)</span><a aria-hidden="true" class="hash-link" href="#ibm-watson-iot-for-gateway-w4g" title="Direct link to heading">#</a></h4><blockquote><p>IBM Watson IoT for gateway (w4g) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は &#x27;messag-ing.internetofthings.ibmcloud.com&#x27;. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル&#x27;tcp&#x27; 又は&#x27;ssl&#x27; を指定. デフォルト値は &#x27;tcp&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 1883(TCP 接続時)又は 8883(SSL 接続時).</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値は true.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値はfalse.</td></tr><tr><td>org_id</td><td>文字列</td><td>組織 ID. デフォルト値は &#x27;quickstart&#x27;. (16byte)</td></tr><tr><td>gateway type</td><td>文字列</td><td>ゲートウェイタイプデフォルト値は &#x27;sample&#x27;. (20byte)</td></tr><tr><td>gateway id</td><td>文字列</td><td>ゲートウェイID. (20byte)</td></tr><tr><td>event_id</td><td>文字列</td><td>イベントID. デフォルト値は &#x27;sample&#x27;. (128byte)</td></tr><tr><td>lwt_event_id</td><td>文字列</td><td>LWT のイベント ID. デフォルト値は &#x27;lwt&#x27;.</td></tr><tr><td>format_string</td><td>文字列</td><td>データーフォーマット. デフォルト値は &#x27;json&#x27;. (16byte)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr><tr><td>truststore</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>keystore</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft-azure-iot-hubiothub"></a><span id="iothub">Microsoft Azure IoT Hub(iothub)</span><a aria-hidden="true" class="hash-link" href="#microsoft-azure-iot-hubiothub" title="Direct link to heading">#</a></h4><blockquote><p>Microsoft Azure IoT Hub(iothub) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は &#x27;azure-devices.net&#x27;. (MAXHOSTNAMELEN)</td></tr><tr><td>hub_name</td><td>文字列</td><td>接続先ハブ名. (64byte)</td></tr><tr><td>gw_host</td><td>文字列</td><td>ゲートウェイホスト名.( MAXHOSTNAMELEN)</td></tr><tr><td>tail_slash</td><td>論理値</td><td>MQTTトピックの末尾に&#x27;/&#x27;を付けるか否か. デフォルト値は true.</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値はtrue.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値は false.</td></tr><tr><td>lwt_property_bag</td><td>文字列</td><td>LWT Property Bag. (256byte)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr><tr><td>rootCA</td><td>文字列</td><td>X.509 認証に用いる Root CA 証明書ファイルのパス名. (MAXHOSTNAMELEN)</td></tr></tbody></table><hr><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ntt-docomo-toami-for-docomo-t4d"></a><span id="t4d">NTT docomo Toami for DOCOMO (t4d)</span><a aria-hidden="true" class="hash-link" href="#ntt-docomo-toami-for-docomo-t4d" title="Direct link to heading">#</a></h4><blockquote><p>NTT docomo Toami for DOCOMO (t4d) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>url</td><td>文字列</td><td>接続先URL. デフォルト値は <a href="https://xxxx.to4do.com:443" target="_blank" rel="noopener noreferrer">https://xxxx.to4do.com:443</a> . (MAXPATHLEN)</td></tr><tr><td>ssl_verify</td><td>論理値</td><td>サーバー証明書の検証を行うか否か. デフォルト値は false.</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="unixドメインソケット-lsocket"></a><span id="lsocket">UNIXドメインソケット (lsocket)</span><a aria-hidden="true" class="hash-link" href="#unixドメインソケット-lsocket" title="Direct link to heading">#</a></h4><blockquote><p>UNIXドメインソケット (lsocket) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>root_path</td><td>文字列</td><td>送り先Unix ドメインソケットのルートパス名. 文字列の先頭が &#x27;@&#x27; の場合は abstract namespace と解釈する. デフォルト値は &#x27;/tmp&#x27;.  (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="kddi-iot-クラウド-standardkddi_std"></a><span id="kddi_std">KDDI IoT クラウド Standard(kddi_std)</span><a aria-hidden="true" class="hash-link" href="#kddi-iot-クラウド-standardkddi_std" title="Direct link to heading">#</a></h4><blockquote><p>KDDI IoTクラウドStandard(kddi_std) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は &#x27;datalink.m2m-cloud-std.kddi.ne.jp&#x27;.  (MAXHOSTNAMELEN)</td></tr><tr><td>ssl_verify</td><td>論理値</td><td>サーバー証明書の検証を行うか否か. デフォルト値は false.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 443.</td></tr><tr><td>termid</td><td>文字列</td><td>端末ID. (16byte)</td></tr><tr><td>username</td><td>文字列</td><td>BASIC 認証用ユーザー名. 空の場合、認証は行わない. (32byte)</td></tr><tr><td>password</td><td>文字列</td><td>BASIC 認証用パスワード. 空の場合、認証は行わない. (32byte)</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="nifty-iot-device-hub-nf_dvhub"></a><span id="nf_dvhub">NIFTY IoT Device Hub (nf_dvhub)</span><a aria-hidden="true" class="hash-link" href="#nifty-iot-device-hub-nf_dvhub" title="Direct link to heading">#</a></h4><blockquote><p>NIFTY IoT Device Hub (nf_dvhub) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>host</td><td>文字列</td><td>接続先ホスト名. デフォルト値は &#x27;iot-device.jp-east-1.mqtt.cloud.nifty.com&#x27;  (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル &#x27;tcp&#x27; 又は &#x27;ssl&#x27; を指定. デフォルト値は &#x27;tcp&#x27;.</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>rootCA</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名.</td></tr></tbody></table><p>NIFTY IoT Device Hub は、2018年11月30日をもってサービスを終了しています。<br>
また、NIFTY IoT Device Hub と <a href="https://github.com/devicehubnet" target="_blank" rel="noopener noreferrer">DEVICEHUB</a>は、異なるサービスであり、本設定オブジェクを用いて<a href="https://github.com/devicehubnet" target="_blank" rel="noopener noreferrer">DEVICEHUB</a>にデータを送ることはできません。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="plathome-独自仕様-web-サーバpd-web"></a><span id="pd_web">Plat&#x27;Home 独自仕様　Web サーバ(pd web)</span><a aria-hidden="true" class="hash-link" href="#plathome-独自仕様-web-サーバpd-web" title="Direct link to heading">#</a></h4><blockquote><p>Plat&#x27;Home 独自仕様 Web サーバ(pd web) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>url</td><td>文字列</td><td>接続先URL. (MAXPATHLEN)</td></tr><tr><td>ssl_verify</td><td>論理値</td><td>サーバー証明書の検証を行うか否か. デフォルト値は false.</td></tr><tr><td>poll_interval</td><td>整数値</td><td>PD Web ではメッセージの送信と同時に下流方向へのメッセージを取得するが、poll interval には送信すべきメッセージが存在しない場合を想定し、空の接続を起こす間隔(sec)を指定する. デフォルト値は 30.</td></tr><tr><td>username</td><td>文字列</td><td>BASIC 認証用ユーザー名. 空の場合、認証は行わない. (32byte)</td></tr><tr><td>password</td><td>文字列</td><td>BASIC 認証用パスワード. 空の場合、認証は行わない. (32byte)</td></tr><tr><td>max_post_msize</td><td>整数値</td><td>最大ポストサイズ(Mbyte). デフォルト値は 1.</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="google-cloud-iot-core-iotcore"></a><span id="iotcore">Google Cloud IoT Core (iotcore)</span><a aria-hidden="true" class="hash-link" href="#google-cloud-iot-core-iotcore" title="Direct link to heading">#</a></h4><blockquote><p>Google Cloud IoT Core (iotcore) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>host</td><td>文字列</td><td>接続先ホスト名(MAXHOSTNAMELEN)</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 8883.</td></tr><tr><td>project_id</td><td>文字列</td><td>プロジェクトID. (32bytes)</td></tr><tr><td>cloud_region</td><td>文字列</td><td>Cloud リージョン. (16bytes)</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値は true.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値は false.</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr><tr><td>rootCA</td><td>文字列</td><td>SSL 接続に用いるRoot CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="tcpソケット-ltcp"></a><span id="ltcp">TCPソケット (ltcp)</span><a aria-hidden="true" class="hash-link" href="#tcpソケット-ltcp" title="Direct link to heading">#</a></h4><blockquote><p>TCPソケット (ltcp) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>ip_addr</td><td>文字列</td><td>接続先IP アドレス. デフォルト値は &#x27;127.0.0.1&#x27;. (16byte)</td></tr><tr><td>delimiter</td><td>文字列</td><td>メッセージのセパレータコード. デフォルト値は&#x27;0x00&#x27;. 例えば CRLF コードをセパレータとする場合は &#x27;0x0d0a&#x27;.  (7byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="amazon-aws-iot-websocketawsiot_ws"></a><span id="awsiot_ws">Amazon AWS IoT [Websocket](awsiot_ws)</span><a aria-hidden="true" class="hash-link" href="#amazon-aws-iot-websocketawsiot_ws" title="Direct link to heading">#</a></h4><blockquote><p>Amazon AWS IoT [Websocket](awsiot_ws) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>host</td><td>文字列</td><td>接続先ホスト名. (MAXHOSTNAMELEN)</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 443.</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値は false.</td></tr><tr><td>accessid</td><td>文字列</td><td>アクセスID. (128byte)</td></tr><tr><td>accesskey</td><td>文字列</td><td>アクセスキー. (128byte)</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft-azure-iot-hubwebsocket-iothub_ws"></a><span id="iothub_ws">Microsoft Azure IoT Hub[Websocket] (iothub_ws)</span><a aria-hidden="true" class="hash-link" href="#microsoft-azure-iot-hubwebsocket-iothub_ws" title="Direct link to heading">#</a></h4><blockquote><p>Microsoft Azure IoT Hub[Websocket] (iothub_ws) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>domain</td><td>文字列</td><td>接続先ドメイン名. デフォルト値は &#x27;azure-devices.net&#x27;. (MAXHOSTNAMELEN)</td></tr><tr><td>hub_name</td><td>文字列</td><td>接続先ハブ名. (64byte)</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値はtrue.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>lwt</td><td>論理値</td><td>Last Will and Testament (LWT) を使用するか否か. デフォルト値は false.</td></tr><tr><td>lwt_qos</td><td>整数値</td><td>LWT の QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>lwt_retained</td><td>論理値</td><td>LWT の Retained. デフォルト値は false.</td></tr><tr><td>lwt_property_bag</td><td>文字列</td><td>LWT Property Bag. (256byte)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr></tbody></table><p>Proxy を使用する場合は、環境変数 http_proxy 又は https_proxy に設定します。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ダミー出力-dummy"></a><span id="dummy">ダミー出力 (dummy)</span><a aria-hidden="true" class="hash-link" href="#ダミー出力-dummy" title="Direct link to heading">#</a></h4><blockquote><p>ダミー出力 (dummy) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>log</td><td>論理値</td><td>ペイロードとそのサイズのログ出力を行う. デフォルト値は false.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="softbank-iot-sbiot"></a><span id="sbiot">SoftBank IoT (sbiot)</span><a aria-hidden="true" class="hash-link" href="#softbank-iot-sbiot" title="Direct link to heading">#</a></h4><blockquote><p>SoftBank IoT (sbiot) の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>res_memory</td><td>整数値</td><td>常駐メモリの増加分の上限値(Mbyte). 上限値を超えると送信プロセスを再起動する. デフォルト値は 32.</td></tr><tr><td>host</td><td>文字列</td><td>接続先ホストをIP アドレス又は FQDN で指定. (MAXHOSTNAMELEN)</td></tr><tr><td>protocol</td><td>文字列</td><td>接続プロトコル &#x27;tcp&#x27; 又は &#x27;ssl&#x27; を指定. デフォルト値は &#x27;ssl&#x27;.</td></tr><tr><td>port</td><td>整数値</td><td>接続先ポート番号. デフォルト値は 8883.</td></tr><tr><td>keepaliveinterval</td><td>整数値</td><td>MQTT の Keepalive 間隔(sec). デフォルト値は 10.</td></tr><tr><td>cleansession</td><td>論理値</td><td>MQTT の Clean session. デフォルト値は true.</td></tr><tr><td>reliable</td><td>論理値</td><td>MQTT の Reliable. デフォルト値は true.</td></tr><tr><td>qos</td><td>整数値</td><td>MQTT の送信用 QoS, 0～2 を指定. デフォルト値は 0.</td></tr><tr><td>retained</td><td>論理値</td><td>MQTT の Retained. デフォルト値は false.</td></tr><tr><td>rcv_qos</td><td>整数値</td><td>MQTT の受信用 QoS, 0～2 を指定. デフォルト値は 1.</td></tr><tr><td>resp</td><td>論理値</td><td>応答出力を受け取るか否か. デフォルト値は false.</td></tr><tr><td>cloud_id</td><td>文字列</td><td>MQTT の送信トピックに与えられる送信先クラウド名. デフォルト値は &#x27;CSE1000&#x27;. (64byte)</td></tr><tr><td>client_id</td><td>文字列</td><td>MQTT 接続に用いる Client ID. (96byte)</td></tr><tr><td>ae_id</td><td>文字列</td><td>接続に用いる SoftBank IoT の AE-ID. (64byte)</td></tr><tr><td>password</td><td>文字列</td><td>パスワード認証に用いるパスワード. (128byte)</td></tr><tr><td>asset</td><td>文字列</td><td>接続に用いる SoftBank IoT のアセット名. (64byte)</td></tr><tr><td>truststore</td><td>文字列</td><td>SSL 接続に用いる Root CA 証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>keystore</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名.  (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名.  (MAXPATHLEN)</td></tr></tbody></table><hr><p>SoftBank IoT に関わる実装は、SoftBank IoT プラットフォームネットワーク接続仕様(Rev.1.1.1)に準拠し「SoftBankスマ可視化専用クラウド」の仕様に合わせて実装されています。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ftp-サーバftp"></a><span id="ftp">FTP サーバ(ftp)</span><a aria-hidden="true" class="hash-link" href="#ftp-サーバftp" title="Direct link to heading">#</a></h4><blockquote><p>FTP サーバ (ftp)の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値はfalse.</td></tr><tr><td>interval</td><td>整数値</td><td>サーバへの送信間隔(sec). デフォルト値は 30.</td></tr><tr><td>expier</td><td>整数値</td><td>キャッシュのデータ保持時間(sec). デフォルト値 0 の場合はデータが送信さるまで無制限.</td></tr><tr><td>restart</td><td>整数値</td><td>送信プロセスの再起動間隔(sec). デフォルト値は 604800、0 の場合は再起動しない.</td></tr><tr><td>url</td><td>文字列</td><td>&#x27;ftp://&#x27; から始まる接続先 URL.  (MAXPATHLEN)</td></tr><tr><td>username</td><td>文字列</td><td>接続に用いるユーザー名. (32byte)</td></tr><tr><td>password</td><td>文字列</td><td>パスワード認証に用いるパスワード. (32byte)</td></tr><tr><td>per_device</td><td>論理値</td><td>デバイス毎にファイル名を変えて送信する. デフォルト値は false.</td></tr><tr><td>fn_prefix</td><td>文字列</td><td>ファイル名のプリフィック. &#x27;per_device&#x27; キーが false の時のみ有効. (64byte).</td></tr><tr><td>fn_suffix</td><td>文字列</td><td>ファイル名のサフィック.  &#x27;per_device&#x27; キーが false の時のみ有効. (64byte).</td></tr><tr><td>fn_time</td><td>文字列</td><td>ファイル名のプリフィックとサフィックの間に挿入される PD Repeater がデータを受け取った時刻文字列のの仕様. &#x27;none&#x27;(挿入無し), &#x27;oldest&#x27;(最古), &#x27;latest&#x27;(最新), &#x27;both&#x27;(両方) のいずれか. &#x27;oldest&#x27; 又は &#x27;latest&#x27; 場合は &#x27;CCyymmddHHMMSS&#x27;、&#x27;both&#x27; の場合は、 &#x27;CCyymmddHHMMSS-CCyymmddHHMMSS&#x27;.</td></tr></tbody></table><p>FTPサーバに関わる実装は、2020年6月現在試験的なもので、設定オブェクトについては予告なく変更される場合があります。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="devices-オブジェクト"></a><span id="devices_obj">devices オブジェクト</span><a aria-hidden="true" class="hash-link" href="#devices-オブジェクト" title="Direct link to heading">#</a></h3><blockquote><p>devices オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>localname</td><td>文字列</td><td>デバイスのローカル名(デバイス番号). (32byte)</td></tr><tr><td>bind</td><td>文字列</td><td>データを受け取るソケット名. 文字列の先頭が &#x27;@&#x27; の場合は abstract　namespace と解釈します.  空の場合は、デフォルト値 &#x27;@/pd_repeater/&lt;localname&gt;.sock&#x27; が設定されます.</td></tr><tr><td>push_to</td><td>文字列</td><td>制御メッセージの送り先ソケット名. 文字列の先頭が &#x27;@&#x27; の場合は abstract　namespace と解釈します. 空の場合は、デフォルト値 &#x27;@/pd_handler/&lt;localname&gt;&#x27;.sock が設定されます.</td></tr><tr><td>buffer_size</td><td>整数値</td><td>データのバッファサイズ(byte). デフォルト値は 4096</td></tr><tr><td>truncate</td><td>実数値</td><td>データを間引くための入力データを受け付けない時間(msec). デフォルト値 0 の場合は間引かない.</td></tr><tr><td>receive</td><td>論理値</td><td>クラウドからメッセージを受け取る下流方向制御) か否か. デフォルト値は false.</td></tr><tr><td><a href="#pd_ex_dev">pd_ex</a></td><td>JSON obj</td><td>PD Exchenge 固有の設定オブジェクト</td></tr><tr><td><a href="#mqtt_dev">mqtt</a></td><td>JSON obj</td><td>汎用のMQTT ブローカー固有の設定オブジェクト</td></tr><tr><td><a href="#w4d_dev">w4d</a></td><td>JSON obj</td><td>IBM Watson IoT for device 固有の設定オブジェクト</td></tr><tr><td><a href="#kinesis_dev">kinesis</a></td><td>JSON obj</td><td>Amazon Kinesis 固有の設定オブジェクト</td></tr><tr><td><a href="#pgsql_dev">pgsql</a></td><td>JSON obj</td><td>PostgreSQL データベース固有の設定オブジェクト</td></tr><tr><td><a href="#mysql_dev">mysql</a></td><td>JSON obj</td><td>MySQL データベース固有の設定オブジェクト</td></tr><tr><td><a href="#web_dev">web</a></td><td>JSON obj</td><td>汎用のWeb サーバ固有の設定オブジェクト</td></tr><tr><td><a href="#awsiot_dev">awsiot</a></td><td>JSON obj</td><td>Amazon AWS IoT 固有の設定オブジェクト</td></tr><tr><td><a href="#eventhub_dev">eventhub</a></td><td>JSON obj</td><td>Microsoft Azure Event Hubs 固有の設定オブジェクト</td></tr><tr><td><a href="#w4g_dev">w4g</a></td><td>JSON obj</td><td>IBM Watson IoT for gateway 固有の設定オブジェクト</td></tr><tr><td><a href="#iothub_dev">iothub</a></td><td>JSON obj</td><td>Microsoft Azure IoT Hub 固有の設定オブジェクト</td></tr><tr><td><a href="#t4d_dev">t4d</a></td><td>JSON obj</td><td>NTT docomo Toami for DOCOMO 固有の設定オブジェクト</td></tr><tr><td><a href="#lsocket_dev">lsocket</a></td><td>JSON obj</td><td>Unix ドメインソケットへデータを送るための固有の設定オブジェクト</td></tr><tr><td><a href="#kddi_std_dev">kddi_std</a></td><td>JSON obj</td><td>KDDI IoT クラウド Standard 固有の設定オブジェクト</td></tr><tr><td><a href="#nf_dvhub_dev">nf_dvhub</a></td><td>JSON obj</td><td>NIFTY IoT Device Hub 固有の設定オブジェクト</td></tr><tr><td><a href="#pd_web_dev">pd_web</a></td><td>JSON obj</td><td>Plat&#x27;Home 独自仕様の Web サーバ固有の設定オブジェクト</td></tr><tr><td><a href="#iotcore_dev">iotcore</a></td><td>JSON obj</td><td>Google Cloud IoT Core 固有の設定オブジェクト</td></tr><tr><td><a href="#ltcp_dev">ltcp</a></td><td>JSON obj</td><td>TCP ソケット固有の設定オブジェクト</td></tr><tr><td><a href="#awsiot_dev">awsiot_ws</a></td><td>JSON obj</td><td>Amazon AWS IoT へ MQTT over Websocket でデータを送るための固有の設定オブジェクト</td></tr><tr><td><a href="#iothub_dev">iothub_ws</a></td><td>JSON obj</td><td>Microsoft Azure IoT Hub へ MQTT over Websocket でデータを送るための固有の設定オブジェクト</td></tr><tr><td><a href="#dummy_dev">dummy</a></td><td>JSON obj</td><td>ダミー出力 固有の設定オブジェクト</td></tr><tr><td><a href="#sbiot_dev">sbiot</a></td><td>JSON obj</td><td>SoftBank IoT へデータを送るための固有の設定オブジェクト</td></tr><tr><td><a href="#ftp_dev">ftp</a></td><td>JSON obj</td><td>FTPサーバへデータを送るための固有の設定オブジェクト</td></tr></tbody></table><p>クラウドインデックスキーについては servers オブジェクトと同様に同文字列に &#x27;_0&#x27; 又は&#x27;_1&#x27;, &#x27;_2&#x27;, &#x27;_3&#x27; を付加した文字列(例えば &#x27;pd_ex&#x27; について、&#x27;pd_ex_0&#x27;, &#x27;pd_ex_1&#x27;, &#x27;pd_ex_2&#x27;, &#x27;pd_ex_3) を用いることが可能です。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="pd-exchengepd_ex"></a><span id="pd_ex_dev">PD Exchenge(pd_ex)</span><a aria-hidden="true" class="hash-link" href="#pd-exchengepd_ex" title="Direct link to heading">#</a></h4><blockquote><p>PD Exchenge(pd_ex) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>deid_suffix</td><td>文字列</td><td>PD Exchange のデバイスID サフックス.  (9byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="汎用のmqtt-ブローカーmqtt"></a><span id="mqtt_dev">汎用のMQTT ブローカー(mqtt)</span><a aria-hidden="true" class="hash-link" href="#汎用のmqtt-ブローカーmqtt" title="Direct link to heading">#</a></h4><blockquote><p>汎用のMQTT ブローカー(mqtt) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>unique_id</td><td>文字列</td><td>ユニークID.  (20byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ibm-watson-iot-for-device-w4d-1"></a><span id="w4d_dev">IBM Watson IoT for device (w4d)</span><a aria-hidden="true" class="hash-link" href="#ibm-watson-iot-for-device-w4d-1" title="Direct link to heading">#</a></h4><blockquote><p>IBM Watson IoT for device (w4d) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>device_id</td><td>文字列</td><td>デバイスID.  (20byte)</td></tr><tr><td>device_type</td><td>文字列</td><td>デバイスタイプ.  (20byte)</td></tr><tr><td>password</td><td>文字列</td><td>パスワード.  (128byte)</td></tr><tr><td>keystore</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名.  (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="amazon-kinesis-kinesis-1"></a><span id="kinesis_dev">Amazon Kinesis (kinesis)</span><a aria-hidden="true" class="hash-link" href="#amazon-kinesis-kinesis-1" title="Direct link to heading">#</a></h4><blockquote><p>Amazon Kinesis (kinesis) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="postgresql-pgsql-1"></a><span id="pgsql_dev">PostgreSQL (pgsql)</span><a aria-hidden="true" class="hash-link" href="#postgresql-pgsql-1" title="Direct link to heading">#</a></h4><blockquote><p>PostgreSQL (pgsql) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>table</td><td>文字列</td><td>データを書き込むテーブル名. デフォルト値は &#x27;buf&#x27;.</td></tr><tr><td>colum</td><td>文字列</td><td>データを書き込むカラム名. デフォルト値は &#x27;jsonObj&#x27;.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="mysql-mysql-1"></a><span id="mysql_dev">MySQL (mysql)</span><a aria-hidden="true" class="hash-link" href="#mysql-mysql-1" title="Direct link to heading">#</a></h4><blockquote><p>MySQL (mysql) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>table</td><td>文字列</td><td>データを書き込むテーブル名. デフォルト値は &#x27;buf&#x27;.</td></tr><tr><td>colum</td><td>文字列</td><td>データを書き込むカラム名. デフォルト値は &#x27;jsonObj&#x27;.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="汎用のweb-サーバweb"></a><span id="web_dev">汎用のWeb サーバ(web)</span><a aria-hidden="true" class="hash-link" href="#汎用のweb-サーバweb" title="Direct link to heading">#</a></h4><blockquote><p>汎用のWeb サーバ(web) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="amazon-aws-iot-awsiot-1"></a><span id="awsiot_dev">Amazon AWS IoT (awsiot)</span><a aria-hidden="true" class="hash-link" href="#amazon-aws-iot-awsiot-1" title="Direct link to heading">#</a></h4><blockquote><p>Amazon AWS IoT (awsiot) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>client_id</td><td>文字列</td><td>クライアントID. (20byte)</td></tr><tr><td>thing_name</td><td>文字列</td><td>Device Shadowsに用いるthingName. (128byte)</td></tr><tr><td>topic</td><td>文字列</td><td>MQTT の送信トピック. (MAXPATHLEN)</td></tr><tr><td>rcv_topic</td><td>文字列</td><td>MQTT の受信トピック. (MAXPATHLEN)</td></tr><tr><td>lwt_topic</td><td>文字列</td><td>LWT の送信トピック. (MAXPATHLEN)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr><tr><td>cert</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft-azure-event-hubs-eventhub-1"></a><span id="eventhub_dev">Microsoft Azure Event Hubs (eventhub)</span><a aria-hidden="true" class="hash-link" href="#microsoft-azure-event-hubs-eventhub-1" title="Direct link to heading">#</a></h4><blockquote><p>Microsoft Azure Event Hubs (eventhub) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>hub_name</td><td>文字列</td><td>Event Hubs 名. (64byte)</td></tr><tr><td>sas_policy</td><td>文字列</td><td>SAS ポリシー. (64byte)</td></tr><tr><td>sas_key</td><td>文字列</td><td>SAS キー. (64byte)</td></tr><tr><td>properties</td><td>JSON obj</td><td>AMQP のプロパティを JSONオブジェクト文字列で指定する. 配列型とオブジェクト型を含むことはできない.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ibm-watson-iot-for-gateway-w4g-1"></a><span id="w4g_dev">IBM Watson IoT for gateway (w4g)</span><a aria-hidden="true" class="hash-link" href="#ibm-watson-iot-for-gateway-w4g-1" title="Direct link to heading">#</a></h4><blockquote><p>IBM Watson IoT for gateway (w4g) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>device_id</td><td>文字列</td><td>デバイスID. (20byte)</td></tr><tr><td>device_type</td><td>文字列</td><td>デバイスタイプ. (20byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft-azure-iot-hubiothub-1"></a><span id="iothub_dev">Microsoft Azure IoT Hub(iothub)</span><a aria-hidden="true" class="hash-link" href="#microsoft-azure-iot-hubiothub-1" title="Direct link to heading">#</a></h4><blockquote><p>Microsoft Azure IoT Hub(iothub) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>device_id</td><td>文字列</td><td>デバイスID. (128byte)</td></tr><tr><td>device_key</td><td>文字列</td><td>デバイスキー. (65byte)</td></tr><tr><td>transparent</td><td>論理値</td><td>IoT Edge を透過モードで動作させるか否か. デフォルト値は false</td></tr><tr><td>module_id</td><td>文字列</td><td>モジュールID. (64byte). 透過モード時は無視.</td></tr><tr><td>cert</td><td>文字列</td><td>X.509 認証に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>X.509 認証に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ntt-docomo-toami-for-docomo-t4d-1"></a><span id="t4d_dev">NTT docomo Toami for DOCOMO (t4d)</span><a aria-hidden="true" class="hash-link" href="#ntt-docomo-toami-for-docomo-t4d-1" title="Direct link to heading">#</a></h4><blockquote><p>NTT docomo Toami for DOCOMO (t4d) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>gwname</td><td>文字列</td><td>GatewayName. (32byte)</td></tr><tr><td>appkey</td><td>文字列</td><td>AppKey. (64byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="unix-ドメインソケット-lsocket"></a><span id="lsocket_dev">UNIX ドメインソケット (lsocket)</span><a aria-hidden="true" class="hash-link" href="#unix-ドメインソケット-lsocket" title="Direct link to heading">#</a></h4><blockquote><p>UNIXドメインソケット (lsocket) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="kddi-iot-クラウド-standard-kddi_std"></a><span id="kddi_std_dev">KDDI IoT クラウド Standard (kddi_std)</span><a aria-hidden="true" class="hash-link" href="#kddi-iot-クラウド-standard-kddi_std" title="Direct link to heading">#</a></h4><blockquote><p>KDDI IoT クラウドStandard (kddi std) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="nifty-iot-device-hub-nf_dvhub-1"></a><span id="nf_dvhub_dev">NIFTY IoT Device Hub (nf_dvhub)</span><a aria-hidden="true" class="hash-link" href="#nifty-iot-device-hub-nf_dvhub-1" title="Direct link to heading">#</a></h4><blockquote><p>NIFTY IoT Device Hub (nf_dvhub) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>event_type</td><td>文字列</td><td>イベントタイプ. (20byte)</td></tr><tr><td>device_id</td><td>文字列</td><td>デバイスID. (20byte)</td></tr><tr><td>device_api_key</td><td>文字列</td><td>デバイスAPI キー. (169byte)</td></tr></tbody></table><p>NIFTY IoT Device Hub は、2018年11月30日をもってサービスを終了しています。<br>
また、NIFTY IoT Device Hub と <a href="https://github.com/devicehubnet" target="_blank" rel="noopener noreferrer">DEVICEHUB</a>は、異なるサービスであり、本設定オブジェクを用いて<a href="https://github.com/devicehubnet" target="_blank" rel="noopener noreferrer">DEVICEHUB</a>にデータを送ることはできません。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="plathome-独自仕様-web-サーバpd-web-1"></a><span id="pd_web_dev">Plat&#x27;Home 独自仕様 Web サーバ(pd web)</span><a aria-hidden="true" class="hash-link" href="#plathome-独自仕様-web-サーバpd-web-1" title="Direct link to heading">#</a></h4><blockquote><p>Plat&#x27;Home 独自仕様 Web サーバ(pd web) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>id</td><td>文字列</td><td>クライアントID. (128byte)</td></tr><tr><td>key</td><td>文字列</td><td>トークン認証に用いる文字列(アクセスキー). (128byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="google-cloud-iot-core-iotcore-1"></a><span id="iotcore_dev">Google Cloud IoT Core (iotcore)</span><a aria-hidden="true" class="hash-link" href="#google-cloud-iot-core-iotcore-1" title="Direct link to heading">#</a></h4><blockquote><p>Google Cloud IoT Core (iotcore) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>registry_id</td><td>文字列</td><td>レジストリID. (32byte)</td></tr><tr><td>device_id</td><td>文字列</td><td>デバイスID. (32byte)</td></tr><tr><td>jwt_algorithm</td><td>文字列</td><td>JWT アルゴリズム. &#x27;RS256&#x27;, &#x27;ES256&#x27; のいずれか. (6byte)</td></tr><tr><td>cert</td><td>文字列</td><td>SSL 接続に用いる証明書ファイルのパス名. (MAXPATHLEN)</td></tr><tr><td>privatekey</td><td>文字列</td><td>SSL 接続に用いる秘密鍵ファイルのパス名. (MAXPATHLEN)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="tcpソケット-ltcp-1"></a><span id="ltcp_dev">TCPソケット (ltcp)</span><a aria-hidden="true" class="hash-link" href="#tcpソケット-ltcp-1" title="Direct link to heading">#</a></h4><blockquote><p>TCPソケット (ltcp) 固有の設定オブジェクト</p></blockquote><p> |-|-|-|
| enable | 論理値 | デフォルト値は false.|
| port | 整数値 | 接続先ポート番号. デフォルト値は 49152(TCP 接続時).</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="amazon-aws-iotwebsocketawsiot_ws"></a><span id="awsiot_ws_dev">Amazon AWS IoT[Websocket](awsiot_ws)</span><a aria-hidden="true" class="hash-link" href="#amazon-aws-iotwebsocketawsiot_ws" title="Direct link to heading">#</a></h4><blockquote><p>Amazon AWS IoT[Websocket](awsiot_ws) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>client_id</td><td>文字列</td><td>クライアントID. (20byte)</td></tr><tr><td>thing_name</td><td>文字列</td><td>Device Shadowsに用いるthingName. (128byte)</td></tr><tr><td>topic</td><td>文字列</td><td>MQTT の送信トピック. (MAXPATHLEN)</td></tr><tr><td>rcv_topic</td><td>文字列</td><td>MQTT の受信トピック. (MAXPATHLEN)</td></tr><tr><td>lwt_topic</td><td>文字列</td><td>LWT の送信トピック. (MAXPATHLEN)</td></tr><tr><td>lwt_message</td><td>文字列</td><td>LWT の送信メッセージ. (128byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft-azure-iot-hubwebsocketiothub_ws"></a><span id="iothub_ws_dev">Microsoft Azure IoT Hub[Websocket](iothub_ws)</span><a aria-hidden="true" class="hash-link" href="#microsoft-azure-iot-hubwebsocketiothub_ws" title="Direct link to heading">#</a></h4><blockquote><p>Microsoft Azure IoT Hub[Websocket](iothub_ws) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>device_id</td><td>文字列</td><td>デバイスID. (128byte)</td></tr><tr><td>device_key</td><td>文字列</td><td>デバイスキー. (65byte)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ダミー出力dummy"></a><span id="dummy_dev">ダミー出力(dummy)</span><a aria-hidden="true" class="hash-link" href="#ダミー出力dummy" title="Direct link to heading">#</a></h4><blockquote><p>ダミー出力(dummy) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="softbank-iotsbiot"></a><span id="sbiot_dev">SoftBank IoT(sbiot)</span><a aria-hidden="true" class="hash-link" href="#softbank-iotsbiot" title="Direct link to heading">#</a></h4><blockquote><p>SoftBank IoT(sbiot) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>container</td><td>文字列</td><td>SoftBank IoT への接続に用いるコンテナ名. (64byte)</td></tr></tbody></table><p>SoftBank IoT に関わる実装は、SoftBank IoTプラットフォームネットワーク接続仕様(Rev.1.1.1)に準拠し「SoftBankスマ可視専用クラウド」の仕様に合わせて実装されています。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="ftp-サーバftp-1"></a><span id="ftp_dev">FTP サーバ(ftp)</span><a aria-hidden="true" class="hash-link" href="#ftp-サーバftp-1" title="Direct link to heading">#</a></h4><blockquote><p>FTPサーバ (ftp) 固有の設定オブジェクト</p></blockquote><table><thead><tr><th>キー</th><th>データ型</th><th>説明</th></tr></thead><tbody><tr><td>enable</td><td>論理値</td><td>デフォルト値は false.</td></tr><tr><td>fn_prefix</td><td>文字列</td><td>ファイル名のプリフィック. &#x27;per_device&#x27; キーが true の時のみ有効. (64byte)</td></tr><tr><td>fn_suffix</td><td>文字列</td><td>ファイル名のサフィック. &#x27;per_device&#x27; キーが true の時のみ有効. (64byte)</td></tr><tr><td>fn_time</td><td>文字列</td><td>ファイル名のプリフィックとサフィックの間に挿入される PD Repeater がデータを受け取った時刻文字列のの仕様. &#x27;none&#x27;(挿入無し), &#x27;oldest&#x27;(最古), &#x27;latest&#x27;(最新), &#x27;both&#x27;(両方) のいずれか. &#x27;oldest&#x27; 又は &#x27;latest&#x27; 場合は &#x27;CCyymmddHHMMSS&#x27;、&#x27;both&#x27; の場合は、&#x27;CCyymmddHHMMSS-CCyymmddHHMMSS&#x27;.</td></tr></tbody></table><p>FTPサーバに関わる実装は、2020年6月現在試験的なもので、設定オブェクトについては予告なく変更される場合があります。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="下流方向メッセージ"></a><span id="down_stream">下流方向メッセージ</span><a aria-hidden="true" class="hash-link" href="#下流方向メッセージ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="メッセージフォーマット"></a><span id="down_stream_form">メッセージフォーマット</span><a aria-hidden="true" class="hash-link" href="#メッセージフォーマット" title="Direct link to heading">#</a></h3><p>PD Repeater が下流のモジュールに転送するメッセージのフォーマットを示します。</p><blockquote><p>メッセージフォーマット</p></blockquote><table><tr><td>Cloud ID<br>(1Byte)</td><td>Sub ID<br>(1Byte)</td><td>Header<br>Size<br>(2Byte)</td><td>MD5<br>(16Byte)</td><td>                Header                </td><td>                Payload                </td></tr></table><blockquote><p>メッセージフォーマットの説明</p></blockquote><table><thead><tr><th>フィールド名</th><th>説明</th></tr></thead><tbody><tr><td>Cloud ID (1Byte)</td><td>PD Repeater上の便宜上割り当てている送受信先プロトコルの番号</td></tr><tr><td>Sub ID (1Byte)</td><td>PD Repeater上の便宜上割り当てている送受信先のサブ番号(0x00～0x03)</td></tr><tr><td>Header Size (2Byte)</td><td>PD Reperaterで付加されたHeaderのサイズ</td></tr><tr><td>MD5 (16Byte)</td><td>制御メッセージのハッシュ値</td></tr><tr><td>Header</td><td>PD Reperaterで付加されたMQTTのトピックやHTTPの応答ヘッダ</td></tr><tr><td>Payload</td><td>クラウドから送られて来た制御メッセージ</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="cloud-id-とヘッダー"></a><span id="down_stream_cloud_id">Cloud ID とヘッダー</span><a aria-hidden="true" class="hash-link" href="#cloud-id-とヘッダー" title="Direct link to heading">#</a></h3><p>Cloud IDとヘッダーの内容を示します。</p><blockquote><p>Cloud ID とヘッダーの内容</p></blockquote><table><thead><tr><th>クラウド</th><th>Cloud ID</th><th>下流方向制御</th><th>ヘッダーの内容</th></tr></thead><tbody><tr><td>PD Exchange</td><td>0x00</td><td>対応</td><td>Command ID, ApplicationID</td></tr><tr><td>MQTTサーバ</td><td>0x01</td><td>対応</td><td>MQTT受信トピック</td></tr><tr><td>Watson IoT for Device</td><td>0x02</td><td>対応</td><td>MQTT受信トピック <sup>*1</sup></td></tr><tr><td>Amazon Kinesis</td><td>0x03</td><td></td><td></td></tr><tr><td>PostgreSQLサーバ</td><td>0x04</td><td></td><td></td></tr><tr><td>MySQLサーバ</td><td>0x05</td><td></td><td></td></tr><tr><td>WEBサーバ</td><td>0x06</td><td></td><td></td></tr><tr><td>AWS IoT</td><td>0x07</td><td>対応</td><td>MQTT受信トピック</td></tr><tr><td>MS Azure Event hubs</td><td>0x08</td><td></td><td></td></tr><tr><td>Watson IoT for Gateway</td><td>0x09</td><td>対応</td><td>MQTT受信トピック <sup>*1</sup></td></tr><tr><td>MS Azure IoT Hub</td><td>0x0a</td><td>対応</td><td>MQTT受信トピック</td></tr><tr><td>Toami for DOCOMO</td><td>0x0b</td><td></td><td></td></tr><tr><td>ドメインソケット</td><td>0x0c</td><td></td><td></td></tr><tr><td>KDDI IoT クラウドStandard</td><td>0x0d</td><td></td><td></td></tr><tr><td>IoT デバイスハブ</td><td>0x0e</td><td>対応</td><td>MQTT受信トピック<sup>*2</sup></td></tr><tr><td>PH社独自仕様WEBサーバ</td><td>0x0f</td><td>対応</td><td>HTTP応答ヘッダー</td></tr><tr><td>Google IoT Core</td><td>0x10</td><td>対応</td><td>MQTT受信トピック</td></tr><tr><td>TCP</td><td>0x11</td><td>対応</td><td>接続先IPアドレスとポート番号 <sup>*3</sup></td></tr><tr><td>AWS IoT[Websocket]</td><td>0x12</td><td>対応</td><td>MQTT受信トピック</td></tr><tr><td>MS Azure IoT Hub[Websocket]</td><td>0x13</td><td>対応</td><td>MQTT受信トピック</td></tr><tr><td>ダミー出力</td><td>0x14</td><td></td><td></td></tr><tr><td>SoftBankスマ可視専用クラウド</td><td>0x15</td><td>対応</td><td>MQTT受信トピックと oneM2M のJSON制御用オブジェクト<sup>*4</sup></td></tr><tr><td>予約</td><td>0x16</td><td></td><td></td></tr><tr><td>FTPサーバ</td><td>0x17</td><td></td><td></td></tr><tr><td>予約</td><td>0x18</td><td></td><td></td></tr></tbody></table><ol><li>Watson IoT については、ペイロードを &#x27;d&#x27; キーの JSON オブジェクトとしているため、ハッシュ値（MD5）を得た後、デコードし &#x27;d&#x27; キーの JSON オブジェクトのみを制御メッセージとして出力しています。</li><li>IoT デバイスハブについては、ペイロードを &#x27;parameters&#x27; キーのJSONオブジェクトとしているため、ハッシュ値（MD5）を得た後、デコードし &#x27;parameters&#x27; キーの JSON オブジェクトのみを制御メッセージとして出力しています。</li><li>TCPの接続先IPアドレスとポート番号は、次のJSON文字列で付加されます。<div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{ &quot;ip_addr&quot;: &quot;&lt;IP address&gt;&quot;, &quot;port&quot;: &lt;port&gt; }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div></li><li>SoftBank IoT については、oneM2M 仕様のペイロードから &#x27;con&#x27; キーの JSON オブジェクトのみを出力し、これを除く JSON オブジェクトをMQTT 受信トピック文字列に連結しヘッダーとしています。</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="デバイス制御方式に依存した送信メッセージ構文"></a><span id="cloud_matter">デバイス制御方式に依存した送信メッセージ構文</span><a aria-hidden="true" class="hash-link" href="#デバイス制御方式に依存した送信メッセージ構文" title="Direct link to heading">#</a></h2><p>IoT HubのDevice TwinsやAWS IoTのDevice Shadow の制御においては、MQTTプロトコルのトピックを用います。<br>
このためPD Repeaterでは、IoT HubとAWS IoTについて送信メッセージ(PDReperterへの入力)の構文にルールを設けMQTTプロトコルのトピックを制御します。<br>
なお、各送信メッセージをPD Repeaterが待ち受けしているUnix Domainソケットに対して書き込むことで対応の処理が行われます。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="ms-azure-iot-hubの送信メッセージ構文"></a><span id="cloud_matter_iothub">MS Azure IoT Hubの送信メッセージ構文</span><a aria-hidden="true" class="hash-link" href="#ms-azure-iot-hubの送信メッセージ構文" title="Direct link to heading">#</a></h3><p><a href="/docs/openblocks/fw4/data_handling/pd_repeater/iothub">IoT Hub</a>のDevice TwinsとDirect Methodをサポートするため、次の構文が用意されています。</p><p>Device Twinsのプロパティを取得する :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@GET &lt;Request ID&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Device Twinsのプロパティの更新を通知する :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@PATCH &lt;Request ID&gt;;{&lt;Reported&gt;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Direct Methodに対する応答 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@RES &lt;Request ID&gt;,&lt;Status Code&gt;;{&lt;Any Payload&gt;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>ここで、</p><dl><dt>&lt;Request ID&gt; は、</dt><dd>Device Twinsもしくは、Direct Method のリクエストID</dd><dt>&lt;Reported&gt;は、</dt><dd>Device Twins のreportedプロパティ（JSONオブジェクト）</dd><dt>&lt;Status Code&gt; は、</dt><dd>Direct Methodの実行ステータスコード、正常時は 200.</dd><dt>&lt;Any Payload&gt; は、</dt><dd>Direct Methodに対する応答ペイロード（JSONオブジェクト）</dd></dl>です。<br><br><p>これらの機能を利用するためには、 IoT Hub からの下流方向メッセージ(Device　Twins, Direct Method)を処理するアプリケーションの開発が必要となります。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="aws-iotの送信メッセージ構文"></a><span id="cloud_matter_awsiot">AWS IoTの送信メッセージ構文</span><a aria-hidden="true" class="hash-link" href="#aws-iotの送信メッセージ構文" title="Direct link to heading">#</a></h3><p>AWS IoT の Device Shadowをサポートするため、次の構文が用意されています。</p><p>Device Shadowの取得 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@GET {}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Device Shadowの更新 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@UPDATE {&quot;state&quot;:{&quot;reported&quot;: &lt;Reported&gt;} }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Device Shadowの削除 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@DELETE {}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>ここで、</p><dl><dt>&lt;Reported&gt; は、</dt><dd>Device Shadow のreportedプロパティ(JSONオブジェクト)</dd></dl>です。<br><br><p>なお、モノの名前thingNameは、<a href="/docs/openblocks/fw4/data_handling/pd_repeater/awsiot">AWS IoT(awsiot)</a>又は <a href="/docs/openblocks/fw4/data_handling/pd_repeater/awsiot_ws">AWS IoT[Websocket](awsiot_ws)</a>設定された値が用いられます。<br>
また、AWS IoTサービスからdesiredプロパティを受け取るためには、 AWS IoT からの下流方向メッセージを処理するアプリケーションの開発が必要となります。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="mqttサーバーの送信メッセージ構文"></a><span id="cloud_matter_mqtt">MQTTサーバーの送信メッセージ構文</span><a aria-hidden="true" class="hash-link" href="#mqttサーバーの送信メッセージ構文" title="Direct link to heading">#</a></h3><p><a href="/docs/openblocks/fw4/data_handling/pd_repeater/mqtt">MQTTサーバー</a>においては、メッセージ毎にトピックを柔軟に変更することができます。</p><p>MQTTトピックの変更 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@TOPIC &lt;topic&gt;;{&lt;Any Payload&gt;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>MQTTトピック ユニークIDの変更 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@UNIQUE_ID &lt;unique id&gt;;{&lt;Any Payload&gt;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>MQTTトピック プレフィックスの変更 :</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@TOPIC_PREFIX &lt;topic prefix&gt;;{&lt;Any Payload&gt;}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="plathome-独自仕様-webサーバ"></a><span id="pd_web_spec">Plat&#x27;Home 独自仕様 WEBサーバ</span><a aria-hidden="true" class="hash-link" href="#plathome-独自仕様-webサーバ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="httpヘッダー"></a><span id="pd_web_header">HTTPヘッダー</span><a aria-hidden="true" class="hash-link" href="#httpヘッダー" title="Direct link to heading">#</a></h3><blockquote><p>PD Webで規定されているHTTPヘッダー</p></blockquote><table><thead><tr><th>HTTPヘッダー</th><th>内容</th></tr></thead><tbody><tr><td>X-Pd-Web-Version</td><td>PD Web の仕様のバージョン番号</td></tr><tr><td>X-Pd-Web-Id</td><td>クライアントのID</td></tr><tr><td>X-Pd-Web-Time</td><td>RFC3339準拠のタイムスタンプ</td></tr><tr><td>X-Pd-Web-Md5</td><td>ハッシュ値</td></tr><tr><td>X-Pd-Web-Signature</td><td>ヘッダ情報と鍵(Key)から作成されたハッシュ値</td></tr><tr><td>Content-Type</td><td>application/json;charset=UTF-8</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="トークン"></a><span id="pd_web_tooken">トークン</span><a aria-hidden="true" class="hash-link" href="#トークン" title="Direct link to heading">#</a></h3><p>PD Repeaterで作成されるリクエストヘッダのトークン(X-Pd-Web-Signature)は、Webサーバーにおいて次のPHPスクリプトにより再生できます。</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $hash_hmac_data =</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $_SERVER[&#x27;HTTP_X_PD_WEB_VERSION&#x27;] .</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $_SERVER[&#x27;HTTP_X_PD_WEB_ID&#x27;] .</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $_SERVER[&#x27;HTTP_X_PD_WEB_TIME&#x27;] .</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $_SERVER[&#x27;HTTP_X_PD_WEB_MD5&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $signature = hash_hmac (&#x27;sha256&#x27;, $hash_hmac_data, $key, false);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>ここで $keyは、は $_SERVER[&#x27;HTTP_X_PD_WEB_ID&#x27;] と対をなす予めWebサーバーに保存された鍵(Key)となります。 再生した $signature と $_SERVER[&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;] を比較することで認証します。</p><p>応答ヘッダーのトークン(X-Pd-Web-Signature)は、Webサーバーにおいて次のPHPスクリプトにより作成します。</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $tm = localtime();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $timestamp = sprintf(&quot;%04d-%02d-%02dT%02d:%02d:%02d.000+09:00&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     $tm[5]+1900,$tm[4]+1,$tm[3],$tm[2],$tm[1],$tm[0]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $hash_hmac_data = &#x27;1.0&#x27; . $_SERVER[&#x27;HTTP_X_PD_WEB_ID&#x27;] . $timestamp .</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      md5($payload) . $_SERVER[&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> $signature = hash_hmac (&#x27;sha256&#x27;, $hash_hmac_data, $key, false);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>ここで、$payload は、ペイロードの文字列、送信すべき文字列（下流方向の制御メッセージ）が無い場合は、$payload=&quot;&quot;; とします。 リクエストヘッダのトークンとは異なり、被署名文字列に PD Repeater から送られて来たリクエストヘッダのトークン($_SERVER[&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;])が、含まれる点に注意して下さい。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="webサーバーの実装例phpスクリプト"></a><span id="pd_web_example">Webサーバーの実装例(PHPスクリプト)</span><a aria-hidden="true" class="hash-link" href="#webサーバーの実装例phpスクリプト" title="Direct link to heading">#</a></h3><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-php codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token delimiter important">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 本 PHP スクリプトは PD Repeater の PD Web を利用するための、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * サーバ側 PHP スクリプトのサンプルです.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 本スクリプトを動作させるためには、次の SQL構文で作成された SQLite3 データベース</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * (スクリプト中の $db_file)が必要となります.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     CREATE TABLE client (id TEXT, key TEXT, flags INTEGER, payload BLOB, md5 TEXT);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     CREATE INDEX index_client ON client (id);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * ここで、id は、各センサーデバイス毎に設定する PD Web の ID, key はトークンを  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 作成するための鍵、contens は PD Repeater を介して各センサーデバイスへ送信する</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * JSON 文字列(ペイロード)、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * md5 は JSON文字列のMD5ハッシュ値、flags はペイロードの送信状態を示すコードで</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 0:送信済、1:処理中、2:未送信 を意味します.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 以下に初期値の設定例を示します.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     INSERT INTO client(id, key, flags, payload, md5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                VALUES(&#x27;id00&#x27;, &#x27;key00&#x27;, 0, &#x27;{&quot;any_key&quot;:&quot;any_value&quot;}&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                       &#x27;d29e8a13452e5bc5218d9df7e6ea991f&#x27;);&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     INSERT INTO client(id, key, flags, payload, md5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                VALUES(&#x27;id01&#x27;, &#x27;key10&#x27;, 0, &#x27;{&quot;any_key&quot;:&quot;any_value&quot;}&#x27;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                       &#x27;d29e8a13452e5bc5218d9df7e6ea991f&#x27;);&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * ここで、d29e8a13452e5bc5218d9df7e6ea991 は、&#x27;{&quot;any_key&quot;:&quot;any_value&quot;}&#x27; の MD5値です.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *  Linux OS では、次のコマンドで取得することができます.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     echo -n &#x27;{&quot;any_key&quot;:&quot;any_value&quot;}&#x27; | md5sum</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * ペイロードを送信するには SQLの UPDATEを用いて flags を 2:未送信 に変更します.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * </span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     UPDATE client SET flags = 2 WHERE id = &#x27;id00&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * </span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 勿論ペイロードとMD5値を合わせてセットすることも可能です.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *     UPDATE client</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                SET flags = 2,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                    payload = &#x27;{&quot;any_key&quot;:&quot;new_value&quot;}&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                    md5 = &#x27;94f030ebd7bed4a5ee08fc6fa75ae64e&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *                WHERE id = &#x27;id00&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 送信を終えるを PHP スクリプトは flag を 1 に更新し、&#x27;reply_to&#x27; キーを含む</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 応答ペイロードを待ちます.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 応答ペイロードの例</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *      {&quot;reply_to&quot;:&quot;94f030ebd7bed4a5ee08fc6fa75ae64e&quot;,&quot;result&quot;:&quot;done&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 応答ペイロードは PD Repeater を介してペイロードを受け取る各センサーデバイス</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * (のハンドラ)がPD Repeater 介して返すものです.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * PD Agent や PD Handler Modbus は &#x27;reply_to&#x27; キーで payload の MD5値をハンドリング</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * しますが、独自のハンドラを用いる場合は、独自の応答ペイロードとすることも可能です.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 応答ペイロード受け取ると PHP スクリプトは、データベース上の md5 と reply_to の値を比較し、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * flag を 0 に更新します.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 受信ペイロードに応答ペイロードが含まれていない場合、PHP スクリプトは flag を 2 に戻し、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * 再送します.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> *</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$dump_file</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;/tmp/dump.txt&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$db_file</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;/tmp/pd_web.db&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* HTTP ヘッダーの確認 */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">isset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_VERSION&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">isset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">isset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_TIME&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">isset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_MD5&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="font-style:italic">isset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* HTTPヘッダーが不正な場合 Bad Request 400 を返す. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        http_response_code </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">400</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">exit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* SQLite3 データーベースの読み込み */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 本コードはサンプルであるため、SQL インジェクション対策を省略しています.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">       実運用に利用するためには $_SERVER[&#x27;HTTP_X_PD_WEB_ID&#x27;] のバリデーション</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">       を十分行って下さい. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">SQLite3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$db_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$query</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;SELECT key, flags, payload, md5 FROM client WHERE id = &#x27;%s&#x27;;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$results</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$results</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* HTTP_X_PD_WEB_ID が存在しない場合は Unauthorized 401 を返す. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        http_response_code </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">401</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">close</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">exit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$row</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$results</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">fetchArray</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$key</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$row</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;key&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$row</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;flags&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_tx</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$row</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;payload&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$md5_tx</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$row</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;md5&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* HTTP リクエストヘッダ内の所定の文字列とデータベース上の key を用い</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">       signature を作成する */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_VERSION&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_TIME&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_MD5&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> hash_hmac </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean constant" style="color:rgb(130, 170, 255)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* HTTP 応答ヘッダ共通部の設定 */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">date_default_timezone_set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Asia/Tokyo&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">localtime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$timestamp</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;%04d-%02d-%02dT%02d:%02d:%02d.000+09:00&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1900</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token variable" style="color:rgb(191, 199, 213)">$tm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Version: 1.0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Id: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Time: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Content-Type: application/json;charset=UTF-8&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* リクエストヘッダの被署名文字列が VERSION.ID.TIME.MD5 で構成されているのに対し、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">           応答ヘッダの被署名文字列は、VERSION.ID.TIME.MD5.SIGNATURE </span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">       (SIGNATUREは、リクエストヘッダに含まれる文字列) で構成されている点に注意 */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* HTTP_X_PD_WEB_SIGNATURE と signature が一致しない場合は、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">           401 Unauthorized を返す. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Md5: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;1.0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$timestamp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> hash_hmac </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean constant" style="color:rgb(130, 170, 255)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Signature: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        http_response_code </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">401</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">close</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">exit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">file_get_contents</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;php://input&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_MD5&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* payload の MD5値 と HTTP_X_PD_WEB_MD5 が一致しない場合は、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">           406 Not Acceptable を返す. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Md5: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;1.0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$timestamp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> hash_hmac </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean constant" style="color:rgb(130, 170, 255)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Signature: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        http_response_code </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">406</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">close</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">exit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 受信ペイロードを HTTP リクエストヘッダと共に dump_file に格納する */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">fopen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$dump_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;a+&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_VERSION&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_TIME&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_MD5&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;CONTENT_LENGTH&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fputs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">fclose</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$fp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* flags が 1 (処理中ペイロードあり) の場合、受信ペイロードから、</span></div><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">       &#x27;reply_to&#x27; キーの値を取得 */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$json</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mb_convert_encoding</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;UTF8&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;ASCII,JIS,UTF-8,EUC-JP,SJIS-WIN&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$array</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">json_decode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token boolean constant" style="color:rgb(130, 170, 255)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$array</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!==</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 受信ペイロードは、JSONオブジェクトの配列です. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_count</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">for</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$i</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token variable" style="color:rgb(191, 199, 213)">$i</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token variable" style="color:rgb(191, 199, 213)">$i</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">isset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token variable" style="color:rgb(191, 199, 213)">$i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;reply_to&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* &#x27;reply_to&#x27; キーの値と md5_tx を比較 */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token variable" style="color:rgb(191, 199, 213)">$i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;reply_to&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$md5_tx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                           </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 一致している場合は flags を 0 にする */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                           </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 一致していない場合は flags を 2 にする */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token keyword" style="font-style:italic">break</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$i</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* &#x27;reply_to&#x27; キーが存在しない場合は flags を 2 にする */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* JSON文字列で無い場合、flags を 2 にする */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* データベースの flags を更新する. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$query</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;UPDATE client SET flags = %d WHERE id = &#x27;%s&#x27;;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$results</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* flags が 2 (送信ペイロードあり) の場合は、payload_tx を送り、200 OK を返す. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Md5: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_tx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;1.0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$timestamp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_tx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> hash_hmac </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean constant" style="color:rgb(130, 170, 255)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Signature: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">echo</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$payload_tx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        http_response_code </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* flags を 1 (処理中ペイロードあり) に変更し、データベースの flags を更新する. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$query</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token double-quoted-string string" style="color:rgb(195, 232, 141)">&quot;UPDATE client SET flags = %d WHERE id = &#x27;%s&#x27;;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token variable" style="color:rgb(191, 199, 213)">$flags</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$results</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 200 OK を返す. */</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Md5: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;1.0&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_ID&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$timestamp</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token function" style="color:rgb(130, 170, 255)">md5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$_SERVER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;HTTP_X_PD_WEB_SIGNATURE&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> hash_hmac </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$hash_hmac_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean constant" style="color:rgb(130, 170, 255)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token single-quoted-string string" style="color:rgb(195, 232, 141)">&#x27;Pd_Web_Signature: &#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$signature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        http_response_code </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token variable" style="color:rgb(191, 199, 213)">$db</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token function" style="color:rgb(130, 170, 255)">close</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">exit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token delimiter important">?&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/openblocks/fw4/data_handling_ref/common"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 共通事項</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/openblocks/fw4/data_handling_ref/pd_broker"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">PD Broker »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#デフォルトパス" class="table-of-contents__link"><span id="path">デフォルトパス</span></a></li><li><a href="#設定ファイルの書式" class="table-of-contents__link"><span id="conf">設定ファイルの書式</span></a><ul><li><a href="#構文" class="table-of-contents__link"><span id="syntax">構文</span></a></li><li><a href="#ルートオブジェクト" class="table-of-contents__link"><span id="root_obj">ルートオブジェクト</span></a></li><li><a href="#servers-オブジェクト" class="table-of-contents__link"><span id="servers_obj">servers オブジェクト</span></a></li><li><a href="#devices-オブジェクト" class="table-of-contents__link"><span id="devices_obj">devices オブジェクト</span></a></li></ul></li><li><a href="#下流方向メッセージ" class="table-of-contents__link"><span id="down_stream">下流方向メッセージ</span></a><ul><li><a href="#メッセージフォーマット" class="table-of-contents__link"><span id="down_stream_form">メッセージフォーマット</span></a></li><li><a href="#cloud-id-とヘッダー" class="table-of-contents__link"><span id="down_stream_cloud_id">Cloud ID とヘッダー</span></a></li></ul></li><li><a href="#デバイス制御方式に依存した送信メッセージ構文" class="table-of-contents__link"><span id="cloud_matter">デバイス制御方式に依存した送信メッセージ構文</span></a><ul><li><a href="#ms-azure-iot-hubの送信メッセージ構文" class="table-of-contents__link"><span id="cloud_matter_iothub">MS Azure IoT Hubの送信メッセージ構文</span></a></li><li><a href="#aws-iotの送信メッセージ構文" class="table-of-contents__link"><span id="cloud_matter_awsiot">AWS IoTの送信メッセージ構文</span></a></li><li><a href="#mqttサーバーの送信メッセージ構文" class="table-of-contents__link"><span id="cloud_matter_mqtt">MQTTサーバーの送信メッセージ構文</span></a></li></ul></li><li><a href="#plathome-独自仕様-webサーバ" class="table-of-contents__link"><span id="pd_web_spec">Plat&#39;Home 独自仕様 WEBサーバ</span></a><ul><li><a href="#httpヘッダー" class="table-of-contents__link"><span id="pd_web_header">HTTPヘッダー</span></a></li><li><a href="#トークン" class="table-of-contents__link"><span id="pd_web_tooken">トークン</span></a></li><li><a href="#webサーバーの実装例phpスクリプト" class="table-of-contents__link"><span id="pd_web_example">Webサーバーの実装例(PHPスクリプト)</span></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">製品情報</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.plathome.co.jp/product/openblocks-iot/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenBlocks IoT</a></li><li class="footer__item"><a href="https://www.plathome.co.jp/product/openblocks/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenBlocks - MicroServer</a></li><li class="footer__item"><a href="https://www.plathome.co.jp/product/easyblocks/" target="_blank" rel="noopener noreferrer" class="footer__link-item">EasyBlocksシリーズ</a></li><li class="footer__item"><a href="https://www.plathome.co.jp/product/airmanage2/" target="_blank" rel="noopener noreferrer" class="footer__link-item">AirManage2</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">SNS</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.facebook.com/plathome.co.jp/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/openblocks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter - OpenBlocks</a></li><li class="footer__item"><a href="https://twitter.com/OBSDEV" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter - OpenBlocks開発の人</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">サポート</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.plathome.co.jp/contact/" target="_blank" rel="noopener noreferrer" class="footer__link-item">お問い合わせ</a></li><li class="footer__item"><a href="https://kb.plathome.co.jp/knowledge/" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ</a></li></ul></div></div><div class="text--center"><div>Copyright © 2021 Plat'Home Co., Ltd. All rights reserved.</div></div></div></footer></div>
<script src="/styles.ed7e2b4f.js"></script>
<script src="/runtime~main.964a68ee.js"></script>
<script src="/main.b9e3c0f9.js"></script>
<script src="/1.b61b1d06.js"></script>
<script src="/1a4e3797.18730606.js"></script>
<script src="/1be78505.a4225882.js"></script>
<script src="/c4f5d8e4.062d164b.js"></script>
<script src="/151.32671e9d.js"></script>
<script src="/150.05840bde.js"></script>
<script src="/935f2afb.93164eec.js"></script>
<script src="/149.3a8133d2.js"></script>
<script src="/6c629441.4d4f598f.js"></script>
</body>
</html>